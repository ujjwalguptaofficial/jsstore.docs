"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5062],{4137:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>k});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(n),m=o,k=u["".concat(l,".").concat(m)]||u[m]||d[m]||a;return n?r.createElement(k,i(i({ref:t},c),{},{components:n})):r.createElement(k,i({ref:t},c))}));function k(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:o,i[1]=s;for(var p=2;p<a;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4298:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var r=n(7462),o=(n(7294),n(4137));const a={sidebar_position:3,Keywords:["database","connection","query","indexeddb","jsstore"]},i="Connection",s={unversionedId:"connection",id:"connection",title:"Connection",description:"The Connection class is the main interface for interacting with the indexeddb database and provides various APIs such as select, count, etc. to perform operations on the database.",source:"@site/docs/connection.md",sourceDirName:".",slug:"/connection",permalink:"/docs/connection",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/connection.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,Keywords:["database","connection","query","indexeddb","jsstore"]},sidebar:"tutorialSidebar",previous:{title:"Installation",permalink:"/docs/installation"},next:{title:"Database",permalink:"/docs/database/"}},l={},p=[{value:"With Web Worker",id:"with-web-worker",level:2},{value:"Without web worker",id:"without-web-worker",level:2},{value:"Using import",id:"using-import",level:3},{value:"Using bundler",id:"using-bundler",level:2},{value:"Webpack",id:"webpack",level:3},{value:"Connection in vite",id:"connection-in-vite",level:2},{value:"Important points",id:"important-points",level:2}],c={toc:p},u="wrapper";function d(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"connection"},"Connection"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"Connection")," class is the main interface for interacting with the indexeddb database and provides various APIs such as ",(0,o.kt)("inlineCode",{parentName:"p"},"select"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"count"),", etc. to perform operations on the database."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Connection can be initialize with web worker or without web worker. If initialized with web worker, then all logic will be executed inside web worker. It is strongly recommended to use web worker.")),(0,o.kt)("h2",{id:"with-web-worker"},"With Web Worker"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"var connection = new JsStore.Connection(new Worker('jsstore worker path'));\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"example")," - ",(0,o.kt)("a",{target:"_blank",href:"https://github.com/ujjwalguptaofficial/jsstore-examples/tree/master/simple_example"},(0,o.kt)("a",{parentName:"p",href:"https://github.com/ujjwalguptaofficial/jsstore-examples/tree/master/simple_example"},"https://github.com/ujjwalguptaofficial/jsstore-examples/tree/master/simple_example"))),(0,o.kt)("h2",{id:"without-web-worker"},"Without web worker"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"var connection = new JsStore.Connection();\n")),(0,o.kt)("p",null,"When initializing without a web worker, ensure that you include the jsstore worker file."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"example")," - ",(0,o.kt)("a",{target:"_blank",href:"https://github.com/ujjwalguptaofficial/jsstore-examples/tree/master/without_web_worker"},(0,o.kt)("a",{parentName:"p",href:"https://github.com/ujjwalguptaofficial/jsstore-examples/tree/master/without%5C_web_worker"},"https://github.com/ujjwalguptaofficial/jsstore-examples/tree/master/without\\_web_worker"))),(0,o.kt)("h3",{id:"using-import"},"Using import"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'import workerInjector from "jsstore/dist/worker_injector";\nexport const connection = new Connection();\n\nconnection.addPlugin(workerInjector);\n')),(0,o.kt)("p",null,"To use the ",(0,o.kt)("inlineCode",{parentName:"p"},"connection")," variable in your project, simply import it wherever it is required."),(0,o.kt)("h2",{id:"using-bundler"},"Using bundler"),(0,o.kt)("p",null,"To use bundlers like webpack and vite with ",(0,o.kt)("inlineCode",{parentName:"p"},"jsstore"),", follow these steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Install ",(0,o.kt)("inlineCode",{parentName:"li"},"jsstore")," by running the following command:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm i jsstore\n")),(0,o.kt)("h3",{id:"webpack"},"Webpack"),(0,o.kt)("p",null,"Install the required plugins:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"npm i file-loader -D\n")),(0,o.kt)("p",null,"Create a file ",(0,o.kt)("inlineCode",{parentName:"p"},"jsstore_con.js")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"jsstore_con.ts")," (for TypeScript). This file will be used to create the JsStore connection. You can choose any file name. Inside the file ",(0,o.kt)("inlineCode",{parentName:"p"},"jsstore_con.js"),", write the following code:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'const getWorkerPath = () => {\n\n    // return dev build when env is development\n    if (process.env.NODE_ENV === \'development\') {\n        \n        return require("file-loader?name=scripts/[name].[hash].js!jsstore/dist/jsstore.worker.js");\n\n    }\n    else { // return prod build when env is production\n        \n        return require("file-loader?name=scripts/[name].[hash].js!jsstore/dist/jsstore.worker.min.js");\n        \n    }\n};\n\nconst workerPath = getWorkerPath().default;\nexport const connection = new JsStore.Connection(new Worker(workerPath));\n')),(0,o.kt)("p",null,"The code above creates a ",(0,o.kt)("inlineCode",{parentName:"p"},"connection")," object and exports it. You can import this ",(0,o.kt)("inlineCode",{parentName:"p"},"connection")," object wherever it is needed in your code."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"In the above code, we are using ",(0,o.kt)("strong",{parentName:"p"},"file-loader")," to load the jsstore worker file. However, you are free to use your own technique to load the jsstore worker. One simple approach is to download ",(0,o.kt)("inlineCode",{parentName:"p"},"jsstore.worker.js")," and specify its path.")),(0,o.kt)("h2",{id:"connection-in-vite"},"Connection in vite"),(0,o.kt)("p",null,"First, install the required Vite plugins:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install vite-plugin-externals vite-plugin-file --save-dev\n")),(0,o.kt)("p",null,"Then, configure your ",(0,o.kt)("inlineCode",{parentName:"p"},"vite.config.js")," file:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"import { defineConfig } from 'vite';\nimport externals from 'vite-plugin-externals';\nimport file from 'vite-plugin-file';\n\nexport default defineConfig({\n  plugins: [\n    externals({\n      jsstore: 'jsstore',\n    }),\n    file({\n      assetsDir: 'scripts',\n      outputDir: 'dist',\n      assetsInlineLimit: 0,\n      esModule: false,\n    }),\n  ],\n});\n")),(0,o.kt)("p",null,"After configuring Vite, update your ",(0,o.kt)("inlineCode",{parentName:"p"},"getWorkerPath")," function:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"const getWorkerPath = () => {\n  if (import.meta.env.MODE === 'development') {\n    return import.meta.ROLLUP_FILE_URL_jsstore_dist_jsstore_worker_js;\n  } else {\n    return import.meta.ROLLUP_FILE_URL_jsstore_dist_jsstore_worker_min_js;\n  }\n}; \nconst workerPath = getWorkerPath();\nexport const connection = new JsStore.Connection(new Worker(workerPath));\n")),(0,o.kt)("p",null,"Make sure you adjust the import URLs (",(0,o.kt)("inlineCode",{parentName:"p"},"ROLLUP_FILE_URL"),") according to your project structure and the output directory configured in the Vite configuration."),(0,o.kt)("p",null,"This setup will handle loading the appropriate worker file based on the environment (development or production) when using Vite for your project."),(0,o.kt)("hr",null),(0,o.kt)("p",null,"If you are finding difficult to understand, please take a look at ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/ujjwalguptaofficial/jsstore-examples"},"examples")," or our ",(0,o.kt)("a",{parentName:"p",href:"https://medium.com/jsstore"},"medium page")),(0,o.kt)("h2",{id:"important-points"},"Important points"),(0,o.kt)("p",null,"Here are some important points to keep in mind when working with the ",(0,o.kt)("inlineCode",{parentName:"p"},"Connection")," class:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"connection")," variable represents the connection to a single database and is used to execute all queries for that database."),(0,o.kt)("li",{parentName:"ul"},"Each connection can handle one database at a time."),(0,o.kt)("li",{parentName:"ul"},"It is possible to create multiple connections for multiple databases, but avoid creating multiple connections for a single database as it can lead to data staleness issues. A single connection can handle all queries and executes them one by one, ensuring that you always have the latest data.")))}d.isMDXComponent=!0}}]);